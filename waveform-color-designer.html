<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyChartX æ³¢å½¢é…è‰²æ–¹æ¡ˆè®¾è®¡å™¨ - ç®€ä»ªç§‘æŠ€</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .usage-guide {
            margin-top: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: left;
        }

        .usage-guide h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
            color: #ecf0f1;
        }

        .guide-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .guide-step {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .guide-step:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .step-number {
            background: #3498db;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            flex-shrink: 0;
        }

        .step-text {
            color: #ecf0f1;
            font-size: 14px;
            line-height: 1.4;
        }

        .important-notice {
            margin-top: 25px;
            background: rgba(255, 193, 7, 0.15);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 10px;
            padding: 20px;
            text-align: left;
        }

        .important-notice h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
            color: #fff3cd;
        }

        .notice-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
        }

        .notice-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .notice-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-1px);
        }

        .notice-icon {
            font-size: 18px;
            flex-shrink: 0;
        }

        .notice-text {
            color: #fff3cd;
            font-size: 13px;
            line-height: 1.4;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 800px;
        }

        .sidebar {
            background: #f8f9fa;
            padding: 30px;
            border-right: 1px solid #e9ecef;
        }

        .color-scheme-section {
            margin-bottom: 30px;
        }

        .color-scheme-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }

        .scheme-button {
            display: block;
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: none;
            border-radius: 8px;
            background: white;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 14px;
        }

        .scheme-button:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .scheme-button.active {
            border-color: #3498db;
            background: #3498db;
            color: white;
        }

        .color-preview {
            display: flex;
            gap: 3px;
            margin-top: 5px;
        }

        .color-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .scheme-description {
            font-size: 11px;
            color: #666;
            margin: 3px 0;
            line-height: 1.3;
            font-style: italic;
        }

        .scheme-button.active .scheme-description {
            color: rgba(255, 255, 255, 0.8);
        }

        .preview-area {
            padding: 30px;
            background: white;
        }

        .chart-container {
            background: #000000;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            border: 1px solid #e9ecef;
        }

        .chart-title {
            color: white;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: 500;
        }

        .waveform-canvas {
            width: 100%;
            height: 400px;
            background: #000000;
            border-radius: 5px;
            position: relative;
            border: 1px solid #ddd;
        }

        .grid-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.3;
            pointer-events: none;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 14px;
        }

        .legend-color {
            width: 16px;
            height: 3px;
            border-radius: 2px;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .control-group h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .control-item {
            margin-bottom: 15px;
        }

        .control-item label {
            display: block;
            margin-bottom: 5px;
            color: #495057;
            font-weight: 500;
        }

        .control-item input, .control-item select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 14px;
        }

        .export-section {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #c3e6c3;
        }

        .export-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 80px;
        }

        .export-button:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .export-buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: space-between;
        }

        .color-values {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.6;
        }

        .comparison-mode {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-chart {
            background: #1a1a1a;
            border-radius: 10px;
            padding: 15px;
        }

        .comparison-title {
            color: white;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .comparison-canvas {
            width: 100%;
            height: 300px;
            background: #000;
            border-radius: 5px;
        }

        .export-info {
            margin-top: 15px;
            padding: 12px;
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.2);
            border-radius: 6px;
        }

        .export-info h5 {
            color: #155724;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
        }

        .export-info p {
            color: #155724;
            font-size: 13px;
            line-height: 1.4;
            margin: 0;
        }

        .color-group-info {
            margin: 10px 0;
            padding: 12px;
            background: rgba(52, 152, 219, 0.1);
            border: 1px solid rgba(52, 152, 219, 0.2);
            border-radius: 6px;
            font-size: 12px;
        }

        .info-content {
            margin-bottom: 8px;
            color: #2c3e50;
            line-height: 1.4;
        }

        .info-example {
            color: #2c3e50;
            line-height: 1.4;
        }

        .info-content strong,
        .info-example strong,
        .info-params strong {
            color: #1565c0;
        }

        .info-params {
            margin-top: 8px;
            color: #2c3e50;
            line-height: 1.4;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>EasyChartX æ³¢å½¢é…è‰²æ–¹æ¡ˆè®¾è®¡å™¨</h1>
            <p>ä¸ºç®€ä»ªç§‘æŠ€SeeSharpå·¥å…·åŒ…è®¾è®¡ä¸“ä¸šçš„å¤šé€šé“æ³¢å½¢é…è‰²æ–¹æ¡ˆ</p>
            
            <div class="important-notice">
                <h3>ğŸ’¡ å·¥å…·å®šä½è¯´æ˜</h3>
                <div class="notice-content">
                    <div class="notice-item">
                        <span class="notice-icon">ğŸ¨</span>
                        <span class="notice-text">æœ¬å·¥å…·ä¸“æ³¨äºEasyChartXé…è‰²æ–¹æ¡ˆè®¾è®¡å’Œä»£ç è¾“å‡º</span>
                    </div>
                    <div class="notice-item">
                        <span class="notice-icon">ğŸ“Š</span>
                        <span class="notice-text">æ¨¡æ‹Ÿæ³¢å½¢ä»…ç”¨äºé…è‰²æ•ˆæœé¢„è§ˆï¼Œä¸å¤„ç†çœŸå®ä¿¡å·æ•°æ®</span>
                    </div>
                    <div class="notice-item">
                        <span class="notice-icon">âš¡</span>
                        <span class="notice-text">çœŸå®é¡¹ç›®ä¸­çš„æ³¢å½¢ç”±é‡‡æ ·é¢‘ç‡å’Œå®é™…ä¿¡å·æ•°æ®å†³å®š</span>
                    </div>
                    <div class="notice-item">
                        <span class="notice-icon">ğŸ”§</span>
                        <span class="notice-text">å¯¼å‡ºçš„é…è‰²ä»£ç å¯ç›´æ¥é›†æˆåˆ°æ‚¨çš„EasyChartXé¡¹ç›®ä¸­</span>
                    </div>
                </div>
            </div>
            
            <div class="usage-guide">
                <h3>ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
                <div class="guide-content">
                    <div class="guide-step">
                        <span class="step-number">1</span>
                        <span class="step-text">é€‰æ‹©å·¦ä¾§é…è‰²æ–¹æ¡ˆï¼Œå®æ—¶é¢„è§ˆæ³¢å½¢æ•ˆæœ</span>
                    </div>
                    <div class="guide-step">
                        <span class="step-number">2</span>
                        <span class="step-text">è°ƒæ•´é€šé“æ•°é‡ã€æ³¢å½¢ç±»å‹ã€èƒŒæ™¯è‰²ç­‰å‚æ•°</span>
                    </div>
                    <div class="guide-step">
                        <span class="step-number">3</span>
                        <span class="step-text">å¯ç”¨å¯¹æ¯”æ¨¡å¼å¯åŒæ—¶æŸ¥çœ‹ä¸¤ç§é…è‰²æ–¹æ¡ˆ</span>
                    </div>
                    <div class="guide-step">
                        <span class="step-number">4</span>
                        <span class="step-text">ç‚¹å‡»å¯¼å‡ºæŒ‰é’®ï¼Œç¡®è®¤é…ç½®åä¸‹è½½ä»£ç æ–‡ä»¶</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="color-scheme-section">
                    <h3>ğŸ† æ ‡å‡†é…è‰²æ–¹æ¡ˆ</h3>
                    
                    <button class="scheme-button active" data-scheme="d3category10" title="D3.jsæ ‡å‡†é…è‰²ï¼ŒåŸºäºè‰²å½©ç§‘å­¦è®¾è®¡ï¼Œåœ¨Labè‰²åŸŸä¸­å…·æœ‰æœ€ä½³åŒºåˆ†åº¦">
                        D3 Category10 â­
                        <div class="scheme-description">D3.jsæ ‡å‡†é…è‰²ï¼ŒåŸºäºè‰²å½©ç§‘å­¦è®¾è®¡ï¼Œåœ¨Labè‰²åŸŸä¸­å…·æœ‰æœ€ä½³åŒºåˆ†åº¦</div>
                        <div class="color-preview">
                            <div class="color-dot" style="background: #1f77b4;"></div>
                            <div class="color-dot" style="background: #ff7f0e;"></div>
                            <div class="color-dot" style="background: #2ca02c;"></div>
                            <div class="color-dot" style="background: #d62728;"></div>
                            <div class="color-dot" style="background: #9467bd;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="tableau" title="åŸºäºD3 Category10ï¼Œå•†ä¸šå›¾è¡¨å¹¿æ³›ä½¿ç”¨">
                        Tableauæ ‡å‡† (åŸºäºD3 Category10)
                        <div class="scheme-description">åŸºäºD3 Category10ï¼Œå•†ä¸šå›¾è¡¨å¹¿æ³›ä½¿ç”¨</div>
                        <div class="color-preview">
                            <div class="color-dot" style="background: #1f77b4;"></div>
                            <div class="color-dot" style="background: #ff7f0e;"></div>
                            <div class="color-dot" style="background: #2ca02c;"></div>
                            <div class="color-dot" style="background: #d62728;"></div>
                            <div class="color-dot" style="background: #9467bd;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="d3category20" title="D3.jsæ‰©å±•é…è‰²ï¼Œå‰10è‰²ä¸ºä¸»è‰²ï¼Œå10è‰²ä¸ºå¯¹åº”æµ…è‰²å˜ä½“ï¼Œé€‚åˆå¤§é‡æ•°æ®ç³»åˆ—">
                        D3æ‰©å±•20è‰²
                        <div class="scheme-description">D3.jsæ‰©å±•é…è‰²ï¼Œå‰10è‰²ä¸ºä¸»è‰²ï¼Œå10è‰²ä¸ºå¯¹åº”æµ…è‰²å˜ä½“ï¼Œé€‚åˆå¤§é‡æ•°æ®ç³»åˆ—</div>
                        <div class="color-preview">
                            <div class="color-dot" style="background: #1f77b4;"></div>
                            <div class="color-dot" style="background: #ff7f0e;"></div>
                            <div class="color-dot" style="background: #2ca02c;"></div>
                            <div class="color-dot" style="background: #d62728;"></div>
                            <div class="color-dot" style="background: #9467bd;"></div>
                        </div>
                    </button>
                </div>

                <div class="color-scheme-section">
                    <h3>ğŸ“Š ç»å…¸é…è‰²æ–¹æ¡ˆ</h3>
                    
                    <button class="scheme-button" data-scheme="redblue">
                        çº¢è“ç»å…¸
                        <div class="color-preview">
                            <div class="color-dot" style="background: #FF0000;"></div>
                            <div class="color-dot" style="background: #0000FF;"></div>
                            <div class="color-dot" style="background: #FF6600;"></div>
                            <div class="color-dot" style="background: #0066FF;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="professional">
                        ä¸“ä¸šæ·±è‰²
                        <div class="color-preview">
                            <div class="color-dot" style="background: #E74C3C;"></div>
                            <div class="color-dot" style="background: #3498DB;"></div>
                            <div class="color-dot" style="background: #2ECC71;"></div>
                            <div class="color-dot" style="background: #F39C12;"></div>
                        </div>
                    </button>
                </div>

                <div class="color-scheme-section">
                    <h3>ğŸ¨ ç‰¹æ®Šç”¨é€”</h3>
                    
                    <button class="scheme-button" data-scheme="accessibility">
                        æ— éšœç¢å‹å¥½
                        <div class="color-preview">
                            <div class="color-dot" style="background: #1f77b4;"></div>
                            <div class="color-dot" style="background: #ff7f0e;"></div>
                            <div class="color-dot" style="background: #2ca02c;"></div>
                            <div class="color-dot" style="background: #d62728;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="k">
                        K é£æ ¼ (é«˜å¯¹æ¯”)
                        <div class="color-preview">
                            <div class="color-dot" style="background: #FFD700;"></div>
                            <div class="color-dot" style="background: #00CED1;"></div>
                            <div class="color-dot" style="background: #FF6347;"></div>
                            <div class="color-dot" style="background: #98FB98;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="t">
                        T é£æ ¼ (é²œè‰³)
                        <div class="color-preview">
                            <div class="color-dot" style="background: #FFFF00;"></div>
                            <div class="color-dot" style="background: #00FFFF;"></div>
                            <div class="color-dot" style="background: #FF00FF;"></div>
                            <div class="color-dot" style="background: #00FF00;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="r">
                        R é£æ ¼ (ç°ä»£)
                        <div class="color-preview">
                            <div class="color-dot" style="background: #00D4FF;"></div>
                            <div class="color-dot" style="background: #FF4081;"></div>
                            <div class="color-dot" style="background: #4CAF50;"></div>
                            <div class="color-dot" style="background: #FF9800;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="n">
                        N é£æ ¼ (çº¯è‰²)
                        <div class="color-preview">
                            <div class="color-dot" style="background: #FF0000;"></div>
                            <div class="color-dot" style="background: #00FF00;"></div>
                            <div class="color-dot" style="background: #0000FF;"></div>
                            <div class="color-dot" style="background: #FFFF00;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="m">
                        M é£æ ¼ (ç§‘å­¦)
                        <div class="color-preview">
                            <div class="color-dot" style="background: #0072BD;"></div>
                            <div class="color-dot" style="background: #D95319;"></div>
                            <div class="color-dot" style="background: #EDB120;"></div>
                            <div class="color-dot" style="background: #7E2F8E;"></div>
                        </div>
                    </button>

                    <button class="scheme-button" data-scheme="custom">
                        è‡ªå®šä¹‰é…è‰²
                        <div class="color-preview">
                            <div class="color-dot" style="background: #FF6B6B;"></div>
                            <div class="color-dot" style="background: #4ECDC4;"></div>
                            <div class="color-dot" style="background: #45B7D1;"></div>
                            <div class="color-dot" style="background: #96CEB4;"></div>
                        </div>
                    </button>
                </div>

                <div class="color-scheme-section">
                    <h3>æ˜¾ç¤ºé€‰é¡¹</h3>
                    <div class="control-item">
                        <label>
                            <input type="checkbox" id="showGrid" checked> æ˜¾ç¤ºç½‘æ ¼
                        </label>
                    </div>
                    <div class="control-item">
                        <label>
                            <input type="checkbox" id="showLegend" checked> æ˜¾ç¤ºå›¾ä¾‹
                        </label>
                    </div>
                    <div class="control-item">
                        <label>
                            <input type="checkbox" id="comparisonMode"> å¯¹æ¯”æ¨¡å¼
                        </label>
                    </div>
                    <div class="control-item" id="comparisonSchemeSelector" style="display: none;">
                        <label for="comparisonScheme">å¯¹æ¯”æ–¹æ¡ˆ:</label>
                        <select id="comparisonScheme" title="é€‰æ‹©å¯¹æ¯”çš„é…è‰²æ–¹æ¡ˆ">
                            <option value="d3category10" selected>D3æ ‡å‡†</option>
                            <option value="d3category20">D3æ‰©å±•20è‰²</option>
                            <option value="redblue">çº¢è“ç»å…¸</option>
                            <option value="professional">ä¸“ä¸šæ·±è‰²</option>
                            <option value="accessibility">æ— éšœç¢å‹å¥½</option>
                            <option value="k">K é£æ ¼</option>
                            <option value="t">T é£æ ¼</option>
                            <option value="r">R é£æ ¼</option>
                            <option value="n">N é£æ ¼</option>
                            <option value="m">M é£æ ¼</option>
                            <option value="custom">è‡ªå®šä¹‰é…è‰²</option>
                        </select>
                    </div>
                    <div class="control-item">
                        <label for="lineWidth">çº¿æ¡å®½åº¦:</label>
                        <input type="range" id="lineWidth" min="1" max="5" value="2" title="è°ƒæ•´æ³¢å½¢çº¿æ¡å®½åº¦">
                    </div>
                </div>
            </div>

            <div class="preview-area">
                <div class="controls">
                    <div class="control-group">
                        <h4>ğŸ¨ èƒŒæ™¯é…ç½®</h4>
                        <div class="control-item">
                            <label for="backgroundColor">èƒŒæ™¯é¢œè‰²:</label>
                            <select id="backgroundColor" title="é€‰æ‹©å›¾è¡¨èƒŒæ™¯é¢œè‰²">
                                <option value="white" selected>ç™½è‰² (EasyChartXé»˜è®¤)</option>
                                <option value="black">é»‘è‰² (ç»å…¸)</option>
                                <option value="dark">æ·±ç° (#2c3e50)</option>
                                <option value="custom">è‡ªå®šä¹‰é¢œè‰²</option>
                            </select>
                        </div>
                        <div class="control-item" id="customBgColorPicker" style="display: none;">
                            <label for="customBgColor">è‡ªå®šä¹‰èƒŒæ™¯:</label>
                            <input type="color" id="customBgColor" value="#ffffff" title="é€‰æ‹©è‡ªå®šä¹‰èƒŒæ™¯é¢œè‰²" style="width: 100%; height: 35px; border: 1px solid #ced4da; border-radius: 5px; cursor: pointer;">
                        </div>
                        <div class="control-item">
                            <label>
                                <input type="checkbox" id="showGridInBg" checked> æ˜¾ç¤ºç½‘æ ¼çº¿
                            </label>
                        </div>
                        <div class="control-item" id="gridControls">
                            <label for="gridOpacity">ç½‘æ ¼é€æ˜åº¦:</label>
                            <input type="range" id="gridOpacity" min="0.1" max="1" step="0.1" value="0.3" title="è°ƒæ•´ç½‘æ ¼çº¿é€æ˜åº¦">
                            <span id="gridOpacityValue">30%</span>
                        </div>
                        <div class="control-item" id="gridColorControls">
                            <label for="gridColorMode">ç½‘æ ¼é¢œè‰²:</label>
                            <select id="gridColorMode" title="é€‰æ‹©ç½‘æ ¼çº¿é¢œè‰²æ¨¡å¼">
                                <option value="auto" selected>è‡ªåŠ¨é€‚é…èƒŒæ™¯</option>
                                <option value="light">æµ…è‰² (#cccccc)</option>
                                <option value="dark">æ·±è‰² (#666666)</option>
                                <option value="custom">è‡ªå®šä¹‰é¢œè‰²</option>
                            </select>
                        </div>
                        <div class="control-item" id="customGridColorPicker" style="display: none;">
                            <label for="customGridColor">è‡ªå®šä¹‰ç½‘æ ¼è‰²:</label>
                            <input type="color" id="customGridColor" value="#cccccc" title="é€‰æ‹©è‡ªå®šä¹‰ç½‘æ ¼çº¿é¢œè‰²" style="width: 100%; height: 35px; border: 1px solid #ced4da; border-radius: 5px; cursor: pointer;">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>ğŸ“Š æ³¢å½¢å‚æ•°</h4>
                        <div class="control-item">
                            <label for="channelCount">é€šé“æ•°é‡:</label>
                            <select id="channelCount" title="æ•°æ®é€šé“æ•°é‡ï¼Œå†³å®šæ³¢å½¢é—´è·å’Œå¸ƒå±€">
                                <option value="1">1 é€šé“ (å•çº¿)</option>
                                <option value="2" selected>2 é€šé“ (åŒçº¿)</option>
                                <option value="4">4 é€šé“</option>
                                <option value="6">6 é€šé“</option>
                                <option value="8">8 é€šé“</option>
                                <option value="12">12 é€šé“</option>
                            </select>
                            <small style="color: #666; font-size: 12px;">ğŸ“Š æ•°æ®é€šé“æ•°ï¼Œå½±å“æ³¢å½¢å‚ç›´å¸ƒå±€</small>
                        </div>
                        <div class="control-item">
                            <label for="waveformType">æ³¢å½¢ç±»å‹:</label>
                            <select id="waveformType" title="é€‰æ‹©æ³¢å½¢çš„ç±»å‹">
                                <option value="sine">æ­£å¼¦æ³¢</option>
                                <option value="square">æ–¹æ³¢</option>
                                <option value="triangle">ä¸‰è§’æ³¢</option>
                                <option value="mixed" selected>æ··åˆæ³¢å½¢</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label for="lineCount">çº¿æ¡æ•°é‡:</label>
                            <input type="number" id="lineCount" value="-1" min="-1" max="50" title="å®é™…ç»˜åˆ¶çš„çº¿æ¡æ•°é‡ï¼Œå¯å°äºé€šé“æ•°">
                            <small style="color: #666; font-size: 12px;">ğŸ¨ å®é™…ç»˜åˆ¶çº¿æ¡æ•°ï¼Œ-1=è‡ªåŠ¨åŒ¹é…é€šé“æ•°</small>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>ğŸ¨ è‰²ç³»åˆ†ç»„ (é«˜çº§)</h4>
                        <div class="control-item">
                            <label>
                                <input type="checkbox" id="enableColorGroups"> å¯ç”¨è‰²ç³»åˆ†ç»„
                            </label>
                        </div>
                        <div class="color-group-info" id="colorGroupInfo" style="display: none;">
                            <div class="info-content">
                                <strong>ğŸ’¡ åŠŸèƒ½è¯´æ˜ï¼š</strong>æŒ‰é€»è¾‘å…³ç³»åˆ†ç»„é…è‰²ï¼ŒåŒç»„æ•°æ®ä½¿ç”¨åŒè‰²ç³»çš„æ·±æµ…å˜åŒ–
                            </div>
                            <div class="info-example">
                                <strong>ğŸ“‹ åº”ç”¨ç¤ºä¾‹ï¼š</strong>è®¾å¤‡Aç»„(è“è‰²ç³») vs è®¾å¤‡Bç»„(æ©™è‰²ç³»)ï¼Œåˆæ ¼ç»„(ç»¿è‰²ç³») vs ä¸åˆæ ¼ç»„(çº¢è‰²ç³»)
                            </div>
                            <div class="info-params">
                                <strong>âš™ï¸ å‚æ•°è¯´æ˜ï¼š</strong>
                                <br>â€¢ è‰²ç³»æ•°é‡Ã—æ¯ç»„é¢œè‰²æ•° = æ€»é¢œè‰²æ•°
                                <br>â€¢ æ€»é¢œè‰²æ•°åº” â‰¥ é€šé“æ•°é‡ï¼Œå¦åˆ™ä¼šå¾ªç¯ä½¿ç”¨
                                <br>â€¢ ä¾‹ï¼š2è‰²ç³»Ã—3é¢œè‰² = 6è‰²ï¼Œé€‚åˆ6é€šé“ä»¥å†…
                            </div>
                        </div>
                        <div class="control-item" id="colorGroupControls" style="display: none;">
                            <label for="colorGroupCount">è‰²ç³»æ•°é‡:</label>
                            <select id="colorGroupCount" title="é€‰æ‹©è‰²ç³»æ•°é‡">
                                <option value="1">å•è‰²ç³»</option>
                                <option value="2" selected>åŒè‰²ç³» (å¦‚ï¼šåˆæ ¼/ä¸åˆæ ¼)</option>
                                <option value="3">ä¸‰è‰²ç³»</option>
                                <option value="4">å››è‰²ç³»</option>
                                <option value="5">äº”è‰²ç³»</option>
                            </select>
                        </div>
                        <div class="control-item" id="groupSizeControls" style="display: none;">
                            <label for="colorsPerGroup">æ¯ç»„é¢œè‰²æ•°:</label>
                            <input type="number" id="colorsPerGroup" value="3" min="2" max="8" title="æ¯ä¸ªè‰²ç³»åŒ…å«çš„é¢œè‰²æ•°é‡">
                            <small style="color: #666; font-size: 12px;">æ¯ä¸ªè‰²ç³»å†…çš„æ¸å˜é¢œè‰²æ•°é‡</small>
                        </div>
                    </div>

                    <div class="control-group export-section">
                        <h4>ğŸ“¤ å¯¼å‡ºé…è‰²æ–¹æ¡ˆ</h4>
                        <div class="export-buttons-container">
                            <button class="export-button" onclick="exportColorScheme()">å¯¼å‡º JSON</button>
                            <button class="export-button" onclick="exportCSS()">å¯¼å‡º CSS</button>
                            <button class="export-button" onclick="exportCode()">å¯¼å‡º JS</button>
                            <button class="export-button" onclick="exportCSharp()">å¯¼å‡º C#</button>
                        </div>
                        <div class="export-info">
                            <h5>ğŸ’¡ C# ä»£ç è¯´æ˜</h5>
                            <p>å¯¼å‡ºçš„C#ä»£ç åŒ…å«å®Œæ•´çš„EasyChartXé…ç½®ï¼Œå¯ç›´æ¥å¤åˆ¶åˆ°WinFormsé¡¹ç›®çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ä¸­ã€‚ä»£ç ä¼šè‡ªåŠ¨è®¾ç½®å›¾è¡¨èƒŒæ™¯ã€ç½‘æ ¼çº¿ã€å›¾ä¾‹å’Œå¤šé€šé“æ³¢å½¢é¢œè‰²ï¼Œå¹¶ç”Ÿæˆç¤ºä¾‹æ•°æ®è¿›è¡Œç»˜åˆ¶ã€‚</p>
                        </div>
                    </div>
                </div>

                <div id="chartArea">
                    <div class="chart-container">
                        <div class="chart-title">EasyChartX å¤šé€šé“æ³¢å½¢æ˜¾ç¤ºé¢„è§ˆ</div>
                        <canvas class="waveform-canvas" id="waveformCanvas"></canvas>
                        <svg class="grid-overlay" id="gridOverlay"></svg>
                        <div class="legend" id="legend"></div>
                    </div>
                </div>

                <div id="comparisonArea" class="comparison-mode" style="display: none;">
                    <div class="comparison-chart">
                        <div class="comparison-title">å½“å‰æ–¹æ¡ˆ</div>
                        <div style="position: relative;">
                            <canvas class="comparison-canvas" id="comparisonCanvas1"></canvas>
                            <svg class="grid-overlay" id="gridOverlay1"></svg>
                        </div>
                    </div>
                    <div class="comparison-chart">
                        <div class="comparison-title">å¯¹æ¯”æ–¹æ¡ˆ</div>
                        <div style="position: relative;">
                            <canvas class="comparison-canvas" id="comparisonCanvas2"></canvas>
                            <svg class="grid-overlay" id="gridOverlay2"></svg>
                        </div>
                    </div>
                </div>

                <div class="color-values" id="colorValues"></div>
            </div>
        </div>
    </div>

    <script>
        // é…è‰²æ–¹æ¡ˆå®šä¹‰
        const colorSchemes = {
            d3category10: {
                name: "D3 Category10",
                colors: ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"],
                description: "D3.jsæ ‡å‡†é…è‰²ï¼ŒåŸºäºè‰²å½©ç§‘å­¦è®¾è®¡ï¼Œåœ¨Labè‰²åŸŸä¸­å…·æœ‰æœ€ä½³åŒºåˆ†åº¦",
                category: "standard",
                recommended: true
            },
            tableau: {
                name: "Tableauæ ‡å‡†",
                colors: ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"],
                description: "åŸºäºD3 Category10ï¼Œå•†ä¸šå›¾è¡¨å¹¿æ³›ä½¿ç”¨",
                category: "standard"
            },
            d3category20: {
                name: "D3æ‰©å±•20è‰²",
                colors: ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf", "#aec7e8", "#ffbb78", "#98df8a", "#ff9896", "#c5b0d5", "#c49c94", "#f7b6d2", "#c7c7c7", "#dbdb8d", "#9edae5"],
                description: "D3.jsæ‰©å±•é…è‰²ï¼Œå‰10è‰²ä¸ºä¸»è‰²ï¼Œå10è‰²ä¸ºå¯¹åº”æµ…è‰²å˜ä½“ï¼Œé€‚åˆå¤§é‡æ•°æ®ç³»åˆ—",
                category: "standard"
            },
            redblue: {
                name: "çº¢è“ç»å…¸",
                colors: ["#FF0000", "#0000FF", "#FF6600", "#0066FF", "#FF3333", "#3333FF", "#FF9900", "#0099FF"],
                description: "æœ€å¸¸ç”¨çš„çº¢è“é…è‰²ï¼Œé€‚åˆ1-2æ ¹çº¿çš„åº”ç”¨åœºæ™¯",
                category: "classic"
            },
            professional: {
                name: "ä¸“ä¸šæ·±è‰²",
                colors: ["#E74C3C", "#3498DB", "#2ECC71", "#F39C12", "#9B59B6", "#1ABC9C", "#E67E22", "#34495E"],
                description: "ç°ä»£ä¸“ä¸šé…è‰²ï¼Œé€‚åˆé•¿æ—¶é—´è§‚çœ‹",
                category: "classic"
            },
            accessibility: {
                name: "æ— éšœç¢å‹å¥½",
                colors: ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f"],
                description: "è€ƒè™‘è‰²ç›²ç”¨æˆ·çš„å‹å¥½é…è‰²æ–¹æ¡ˆ",
                category: "special"
            },
            k: {
                name: "K é£æ ¼",
                colors: ["#FFD700", "#00CED1", "#FF6347", "#98FB98", "#DDA0DD", "#F0E68C", "#87CEEB", "#F4A460"],
                description: "é«˜å¯¹æ¯”åº¦é…è‰²ï¼Œæ˜“äºåŒºåˆ†",
                category: "special"
            },
            t: {
                name: "T é£æ ¼", 
                colors: ["#FFFF00", "#00FFFF", "#FF00FF", "#00FF00", "#FF8000", "#8080FF", "#FF80FF", "#80FF80"],
                description: "é²œè‰³æ˜äº®é…è‰²ï¼Œé€‚åˆæš—èƒŒæ™¯",
                category: "special"
            },
            r: {
                name: "R é£æ ¼",
                colors: ["#00D4FF", "#FF4081", "#4CAF50", "#FF9800", "#9C27B0", "#FFEB3B", "#E91E63", "#2196F3"],
                description: "ç°ä»£åŒ–é…è‰²æ–¹æ¡ˆï¼Œå¹³è¡¡ä¸“ä¸šæ€§å’Œç¾è§‚æ€§",
                category: "special"
            },
            n: {
                name: "N é£æ ¼",
                colors: ["#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF", "#FF8000", "#8000FF"],
                description: "çº¯è‰²ç³»é…è‰²ï¼Œé«˜é¥±å’Œåº¦",
                category: "special"
            },
            m: {
                name: "M é£æ ¼",
                colors: ["#0072BD", "#D95319", "#EDB120", "#7E2F8E", "#77AC30", "#4DBEEE", "#A2142F", "#FF6600"],
                description: "ç§‘å­¦è®¡ç®—é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„é…è‰²",
                category: "special"
            },
            custom: {
                name: "è‡ªå®šä¹‰é…è‰²",
                colors: ["#FF6B6B", "#4ECDC4", "#45B7D1", "#96CEB4", "#FFEAA7", "#DDA0DD", "#74B9FF", "#FD79A8"],
                description: "ç°ä»£æ¸å˜é£æ ¼ï¼Œç¾è§‚ä¸”ä¸“ä¸š",
                category: "custom"
            }
        };

        let currentScheme = 'd3category10';
        let animationId;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateDisplay();
            startAnimation();
        });

        function setupEventListeners() {
            // é…è‰²æ–¹æ¡ˆæŒ‰é’®
            document.querySelectorAll('.scheme-button').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.scheme-button').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentScheme = this.dataset.scheme;
                    updateDisplay();
                });
            });

            // æ§åˆ¶é€‰é¡¹
            document.getElementById('channelCount').addEventListener('change', updateDisplay);
            document.getElementById('waveformType').addEventListener('change', updateDisplay);
            document.getElementById('lineWidth').addEventListener('change', updateDisplay);
            document.getElementById('lineCount').addEventListener('change', updateDisplay);
            document.getElementById('showGrid').addEventListener('change', updateDisplay);
            document.getElementById('showLegend').addEventListener('change', updateDisplay);
            
            // èƒŒæ™¯é…ç½®
            document.getElementById('backgroundColor').addEventListener('change', function() {
                const customPicker = document.getElementById('customBgColorPicker');
                if (this.value === 'custom') {
                    customPicker.style.display = 'block';
                } else {
                    customPicker.style.display = 'none';
                }
                updateDisplay();
            });
            
            document.getElementById('customBgColor').addEventListener('change', updateDisplay);
            
            // ç½‘æ ¼çº¿é…ç½®
            document.getElementById('showGridInBg').addEventListener('change', function() {
                const gridControls = document.getElementById('gridControls');
                const gridColorControls = document.getElementById('gridColorControls');
                if (this.checked) {
                    gridControls.style.display = 'block';
                    gridColorControls.style.display = 'block';
                } else {
                    gridControls.style.display = 'none';
                    gridColorControls.style.display = 'none';
                }
                updateDisplay();
            });
            
            document.getElementById('gridOpacity').addEventListener('input', function() {
                const value = Math.round(this.value * 100);
                document.getElementById('gridOpacityValue').textContent = value + '%';
                updateDisplay();
            });
            
            document.getElementById('gridColorMode').addEventListener('change', function() {
                const customGridColorPicker = document.getElementById('customGridColorPicker');
                if (this.value === 'custom') {
                    customGridColorPicker.style.display = 'block';
                } else {
                    customGridColorPicker.style.display = 'none';
                }
                updateDisplay();
            });
            
            document.getElementById('customGridColor').addEventListener('change', updateDisplay);
            
            // è‰²ç³»åˆ†ç»„é…ç½®
            document.getElementById('enableColorGroups').addEventListener('change', function() {
                const colorGroupInfo = document.getElementById('colorGroupInfo');
                const colorGroupControls = document.getElementById('colorGroupControls');
                const groupSizeControls = document.getElementById('groupSizeControls');
                if (this.checked) {
                    colorGroupInfo.style.display = 'block';
                    colorGroupControls.style.display = 'block';
                    groupSizeControls.style.display = 'block';
                } else {
                    colorGroupInfo.style.display = 'none';
                    colorGroupControls.style.display = 'none';
                    groupSizeControls.style.display = 'none';
                }
                updateDisplay();
            });
            
            document.getElementById('colorGroupCount').addEventListener('change', updateDisplay);
            document.getElementById('colorsPerGroup').addEventListener('change', updateDisplay);
            
            document.getElementById('comparisonMode').addEventListener('change', function() {
                const comparisonArea = document.getElementById('comparisonArea');
                const chartArea = document.getElementById('chartArea');
                const comparisonSchemeSelector = document.getElementById('comparisonSchemeSelector');
                
                if (this.checked) {
                    comparisonArea.style.display = 'grid';
                    chartArea.style.display = 'none';
                    comparisonSchemeSelector.style.display = 'block';
                    updateComparisonDisplay();
                } else {
                    comparisonArea.style.display = 'none';
                    chartArea.style.display = 'block';
                    comparisonSchemeSelector.style.display = 'none';
                    updateDisplay();
                }
            });
            
            document.getElementById('comparisonScheme').addEventListener('change', function() {
                if (document.getElementById('comparisonMode').checked) {
                    updateComparisonDisplay();
                }
            });
        }

        function updateDisplay() {
            const canvas = document.getElementById('waveformCanvas');
            const ctx = canvas.getContext('2d');
            
            // è®¾ç½®canvaså°ºå¯¸
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * window.devicePixelRatio;
            canvas.height = rect.height * window.devicePixelRatio;
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            
            drawWaveforms(ctx, canvas.getBoundingClientRect().width, canvas.getBoundingClientRect().height);
            updateChartContainer();
            updateGrid();
            updateLegend();
            updateColorValues();
        }

        function updateComparisonGrid(svgId, width, height) {
            const showGrid = document.getElementById('showGrid').checked;
            const showGridInBg = document.getElementById('showGridInBg').checked;
            const svg = document.getElementById(svgId);
            
            // å¦‚æœä¸¤ä¸ªç½‘æ ¼å¼€å…³éƒ½å…³é—­ï¼Œåˆ™ä¸æ˜¾ç¤ºç½‘æ ¼
            if (!showGrid || !showGridInBg) {
                svg.innerHTML = '';
                return;
            }
            
            const gridColor = getCustomGridColor();
            const gridOpacity = parseFloat(document.getElementById('gridOpacity').value);
            
            svg.style.opacity = gridOpacity;
            
            // è®¡ç®—å®é™…æ³¢å½¢æ˜¾ç¤ºåŒºåŸŸï¼ˆæ’é™¤æ ‡é¢˜åŒºåŸŸï¼Œå¯¹æ¯”æ¨¡å¼æ²¡æœ‰å›¾ä¾‹ï¼‰
            const titleHeight = 40; // å¯¹æ¯”æ¨¡å¼æ ‡é¢˜åŒºåŸŸé«˜åº¦
            const waveformAreaTop = titleHeight;
            const waveformAreaHeight = height - titleHeight;
            
            let gridHTML = '';
            
            // å‚ç›´ç½‘æ ¼çº¿ï¼ˆåªåœ¨æ³¢å½¢åŒºåŸŸæ˜¾ç¤ºï¼‰
            for (let x = 0; x <= width; x += width / 10) {
                gridHTML += `<line x1="${x}" y1="${waveformAreaTop}" x2="${x}" y2="${waveformAreaTop + waveformAreaHeight}" stroke="${gridColor}" stroke-width="1"/>`;
            }
            
            // æ°´å¹³ç½‘æ ¼çº¿ï¼ˆåªåœ¨æ³¢å½¢åŒºåŸŸæ˜¾ç¤ºï¼‰
            for (let y = waveformAreaTop; y <= waveformAreaTop + waveformAreaHeight; y += waveformAreaHeight / 6) {
                gridHTML += `<line x1="0" y1="${y}" x2="${width}" y2="${y}" stroke="${gridColor}" stroke-width="1"/>`;
            }
            
            svg.innerHTML = gridHTML;
        }

        function updateComparisonDisplay() {
            const canvas1 = document.getElementById('comparisonCanvas1');
            const canvas2 = document.getElementById('comparisonCanvas2');
            const ctx1 = canvas1.getContext('2d');
            const ctx2 = canvas2.getContext('2d');
            
            // è®¾ç½®canvaså°ºå¯¸
            [canvas1, canvas2].forEach(canvas => {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width * window.devicePixelRatio;
                canvas.height = rect.height * window.devicePixelRatio;
                canvas.getContext('2d').scale(window.devicePixelRatio, window.devicePixelRatio);
            });
            
            const width = canvas1.getBoundingClientRect().width;
            const height = canvas1.getBoundingClientRect().height;
            
            // ç»˜åˆ¶å½“å‰æ–¹æ¡ˆ
            drawWaveforms(ctx1, width, height);
            
            // ç»˜åˆ¶å¯¹æ¯”æ–¹æ¡ˆï¼ˆä½¿ç”¨ç”¨æˆ·é€‰æ‹©çš„é…è‰²ï¼‰
            const originalScheme = currentScheme;
            const comparisonScheme = document.getElementById('comparisonScheme').value;
            currentScheme = comparisonScheme;
            drawWaveforms(ctx2, width, height);
            currentScheme = originalScheme;
            
            // æ›´æ–°å¯¹æ¯”æ¨¡å¼ä¸‹çš„ç½‘æ ¼çº¿
            updateComparisonGrid('gridOverlay1', width, height);
            updateComparisonGrid('gridOverlay2', width, height);
            
            // æ›´æ–°å¯¹æ¯”æ¨¡å¼ä¸‹çš„é¢œè‰²å€¼ä¿¡æ¯
            updateComparisonColorValues();
        }

        function getBackgroundColor() {
            const bgSelect = document.getElementById('backgroundColor').value;
            switch (bgSelect) {
                case 'white':
                    return '#ffffff';
                case 'black':
                    return '#000000';
                case 'dark':
                    return '#2c3e50';
                case 'custom':
                    return document.getElementById('customBgColor').value;
                default:
                    return '#ffffff';
            }
        }

        function getGridColor(backgroundColor) {
            // æ ¹æ®èƒŒæ™¯è‰²æ™ºèƒ½é€‰æ‹©ç½‘æ ¼çº¿é¢œè‰²
            const bgColor = backgroundColor.toLowerCase();
            if (bgColor === '#ffffff' || bgColor === '#fff' || bgColor === 'white') {
                return '#cccccc'; // æµ…ç°è‰²ç½‘æ ¼çº¿é€‚åˆç™½è‰²èƒŒæ™¯
            } else if (bgColor === '#000000' || bgColor === '#000' || bgColor === 'black') {
                return '#666666'; // æ·±ç°è‰²ç½‘æ ¼çº¿é€‚åˆé»‘è‰²èƒŒæ™¯
            } else {
                // å¯¹äºå…¶ä»–é¢œè‰²ï¼Œè®¡ç®—äº®åº¦æ¥å†³å®šç½‘æ ¼çº¿é¢œè‰²
                const hex = bgColor.replace('#', '');
                const r = parseInt(hex.substr(0, 2), 16);
                const g = parseInt(hex.substr(2, 2), 16);
                const b = parseInt(hex.substr(4, 2), 16);
                const brightness = (r * 299 + g * 587 + b * 114) / 1000;
                return brightness > 128 ? '#999999' : '#666666';
            }
        }

        function getTextColor(backgroundColor) {
            // æ ¹æ®èƒŒæ™¯è‰²æ™ºèƒ½é€‰æ‹©æ–‡å­—é¢œè‰²
            const bgColor = backgroundColor.toLowerCase();
            if (bgColor === '#ffffff' || bgColor === '#fff' || bgColor === 'white') {
                return '#333333'; // æ·±è‰²æ–‡å­—é€‚åˆç™½è‰²èƒŒæ™¯
            } else if (bgColor === '#000000' || bgColor === '#000' || bgColor === 'black') {
                return '#ffffff'; // ç™½è‰²æ–‡å­—é€‚åˆé»‘è‰²èƒŒæ™¯
            } else {
                // å¯¹äºå…¶ä»–é¢œè‰²ï¼Œè®¡ç®—äº®åº¦æ¥å†³å®šæ–‡å­—é¢œè‰²
                const hex = bgColor.replace('#', '');
                const r = parseInt(hex.substr(0, 2), 16);
                const g = parseInt(hex.substr(2, 2), 16);
                const b = parseInt(hex.substr(4, 2), 16);
                const brightness = (r * 299 + g * 587 + b * 114) / 1000;
                return brightness > 128 ? '#333333' : '#ffffff';
            }
        }

        // è‰²ç³»åˆ†ç»„åŠŸèƒ½
        function hexToHsl(hex) {
            const r = parseInt(hex.slice(1, 3), 16) / 255;
            const g = parseInt(hex.slice(3, 5), 16) / 255;
            const b = parseInt(hex.slice(5, 7), 16) / 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0; // achromatic
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            
            return { h: h * 360, s: s * 100, l: l * 100 };
        }
        
        function hslToHex(h, s, l) {
            h = h / 360;
            s = s / 100;
            l = l / 100;
            
            const hue2rgb = (p, q, t) => {
                if (t < 0) t += 1;
                if (t > 1) t -= 1;
                if (t < 1/6) return p + (q - p) * 6 * t;
                if (t < 1/2) return q;
                if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                return p;
            };
            
            let r, g, b;
            
            if (s === 0) {
                r = g = b = l; // achromatic
            } else {
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            
            const toHex = (c) => {
                const hex = Math.round(c * 255).toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            };
            
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
        }
        
        function generateColorGroup(baseColor, count) {
            const hsl = hexToHsl(baseColor);
            const colors = [];
            
            for (let i = 0; i < count; i++) {
                // ä»ä¸»è‰²åˆ°æµ…è‰²çš„æ¸å˜
                const lightnessFactor = 1 - (i * 0.15); // æ¯æ­¥å‡å°‘15%äº®åº¦
                const newLightness = Math.max(hsl.l * lightnessFactor, 20); // æœ€ä½äº®åº¦20%
                const newSaturation = Math.max(hsl.s * (0.8 + i * 0.05), 30); // é€‚å½“è°ƒæ•´é¥±å’Œåº¦
                
                colors.push(hslToHex(hsl.h, newSaturation, newLightness));
            }
            
            return colors;
        }
        
        function generateColorGroups() {
            const enableColorGroups = document.getElementById('enableColorGroups').checked;
            if (!enableColorGroups) {
                return null;
            }
            
            const groupCount = parseInt(document.getElementById('colorGroupCount').value);
            const colorsPerGroup = parseInt(document.getElementById('colorsPerGroup').value);
            
            // åŸºç¡€è‰²ç³»ä¸»è‰²ï¼ˆç¡®ä¿è‰²ç³»é—´æœ‰è¶³å¤ŸåŒºåˆ†åº¦ï¼‰
            const baseColors = [
                '#1f77b4', // è“è‰²ç³»
                '#ff7f0e', // æ©™è‰²ç³»
                '#2ca02c', // ç»¿è‰²ç³»
                '#d62728', // çº¢è‰²ç³»
                '#9467bd'  // ç´«è‰²ç³»
            ];
            
            const colorGroups = [];
            for (let i = 0; i < groupCount; i++) {
                const baseColor = baseColors[i % baseColors.length];
                const groupColors = generateColorGroup(baseColor, colorsPerGroup);
                colorGroups.push(groupColors);
            }
            
            return colorGroups;
        }
        
        function getCurrentColors() {
            const colorGroups = generateColorGroups();
            if (colorGroups) {
                // è‰²ç³»åˆ†ç»„æ¨¡å¼ï¼šå°†æ‰€æœ‰è‰²ç³»çš„é¢œè‰²å¹³é“º
                const allColors = [];
                for (const group of colorGroups) {
                    allColors.push(...group);
                }
                return allColors;
            } else {
                // æ™®é€šæ¨¡å¼ï¼šä½¿ç”¨åŸå§‹é…è‰²æ–¹æ¡ˆ
                return colorSchemes[currentScheme].colors;
            }
        }

        function drawWaveforms(ctx, width, height) {
            const colors = getCurrentColors();
            const channelCount = parseInt(document.getElementById('channelCount').value);
            const lineCountInput = parseInt(document.getElementById('lineCount').value);
            const actualLineCount = lineCountInput === -1 ? channelCount : Math.min(lineCountInput, channelCount);
            const waveformType = document.getElementById('waveformType').value;
            const lineWidth = parseInt(document.getElementById('lineWidth').value);
            const backgroundColor = getBackgroundColor();
            
            // è®¾ç½®èƒŒæ™¯
            ctx.fillStyle = backgroundColor;
            ctx.fillRect(0, 0, width, height);
            
            // è®¡ç®—å®é™…æ³¢å½¢æ˜¾ç¤ºåŒºåŸŸï¼ˆä¼˜åŒ–æ˜¾ç¤ºåŒºåŸŸåˆ†é…ï¼‰
            const titleHeight = 45; // å‡å°‘æ ‡é¢˜åŒºåŸŸé«˜åº¦
            const legendHeight = 35; // å‡å°‘å›¾ä¾‹åŒºåŸŸé«˜åº¦
            const waveformAreaTop = titleHeight;
            const waveformAreaHeight = height - titleHeight - legendHeight;
            
            // ç»˜åˆ¶æ³¢å½¢
            const time = Date.now() * 0.001;
            const points = 1000;
            
            // ä¼˜åŒ–æ³¢å½¢é—´è·å’Œå¹…åº¦è®¡ç®—ï¼Œå¢å¼ºè§†è§‰æ•ˆæœ
            const channelSpacing = waveformAreaHeight / (channelCount + 1); // é€šé“é—´è·
            // å¢åŠ æ³¢å½¢å¹…åº¦ï¼Œä½¿æ³¢å½¢æ›´åŠ é™¡å³­æ˜æ˜¾
            const baseAmplitude = Math.min(channelSpacing * 0.45, waveformAreaHeight * 0.25); // æå‡å¹…åº¦ç³»æ•°
            
            for (let channel = 0; channel < actualLineCount; channel++) {
                ctx.strokeStyle = colors[channel % colors.length];
                ctx.lineWidth = lineWidth;
                ctx.beginPath();
                
                // è®¡ç®—å½“å‰é€šé“çš„ä¸­å¿ƒçº¿ä½ç½®
                const channelCenterY = waveformAreaTop + channelSpacing * (channel + 1);
                
                for (let i = 0; i < points; i++) {
                    const x = (i / points) * width;
                    const t = (i / points) * 6 * Math.PI + time; // å¢åŠ é¢‘ç‡ä½¿æ³¢å½¢æ›´å¯†é›†
                    let waveValue;
                    
                    switch (waveformType) {
                        case 'sine':
                            // æ ‡å‡†æ­£å¼¦æ³¢
                            waveValue = Math.sin(t + channel * 0.7);
                            break;
                        case 'square':
                            // æ ‡å‡†æ–¹æ³¢
                            waveValue = Math.sign(Math.sin(t + channel * 0.7));
                            break;
                        case 'triangle':
                            // æ ‡å‡†ä¸‰è§’æ³¢
                            waveValue = (2 / Math.PI) * Math.asin(Math.sin(t + channel * 0.7));
                            break;
                        case 'mixed':
                            if (channel % 3 === 0) {
                                // æ­£å¼¦æ³¢
                                waveValue = Math.sin(t + channel * 0.7);
                            } else if (channel % 3 === 1) {
                                // æ–¹æ³¢
                                waveValue = Math.sign(Math.sin(t + channel * 0.7));
                            } else {
                                // ä¸‰è§’æ³¢
                                waveValue = (2 / Math.PI) * Math.asin(Math.sin(t + channel * 0.7));
                            }
                            break;
                    }
                    
                    // é™åˆ¶æ³¢å½¢å€¼èŒƒå›´ï¼Œé˜²æ­¢è¿‡åº¦å¤¸å¼ 
                    waveValue = Math.max(-1, Math.min(1, waveValue));
                    
                    // è®¡ç®—æœ€ç»ˆçš„Yåæ ‡ï¼Œåº”ç”¨åŠ¨æ€å¹…åº¦è°ƒæ•´
                    const dynamicAmplitude = baseAmplitude * (0.8 + 0.4 * Math.sin(time * 0.5 + channel)); // è½»å¾®çš„å¹…åº¦å˜åŒ–
                    const y = channelCenterY + waveValue * dynamicAmplitude;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                
                ctx.stroke();
            }
        }

        function getCustomGridColor() {
            const gridColorMode = document.getElementById('gridColorMode').value;
            const backgroundColor = getBackgroundColor();
            
            switch (gridColorMode) {
                case 'auto':
                    return getGridColor(backgroundColor);
                case 'light':
                    return '#cccccc';
                case 'dark':
                    return '#666666';
                case 'custom':
                    return document.getElementById('customGridColor').value;
                default:
                    return getGridColor(backgroundColor);
            }
        }

        function updateGrid() {
            const showGrid = document.getElementById('showGrid').checked;
            const showGridInBg = document.getElementById('showGridInBg').checked;
            const svg = document.getElementById('gridOverlay');
            
            // å¦‚æœä¸¤ä¸ªç½‘æ ¼å¼€å…³éƒ½å…³é—­ï¼Œåˆ™ä¸æ˜¾ç¤ºç½‘æ ¼
            if (!showGrid || !showGridInBg) {
                svg.innerHTML = '';
                return;
            }
            
            const gridColor = getCustomGridColor();
            const gridOpacity = parseFloat(document.getElementById('gridOpacity').value);
            
            svg.style.opacity = gridOpacity;
            
            const width = svg.clientWidth;
            const height = svg.clientHeight;
            
            // è®¡ç®—å®é™…æ³¢å½¢æ˜¾ç¤ºåŒºåŸŸï¼ˆæ’é™¤æ ‡é¢˜å’Œå›¾ä¾‹åŒºåŸŸï¼‰
            const titleHeight = 60; // æ ‡é¢˜åŒºåŸŸé«˜åº¦
            const legendHeight = 50; // å›¾ä¾‹åŒºåŸŸé«˜åº¦
            const waveformAreaTop = titleHeight;
            const waveformAreaHeight = height - titleHeight - legendHeight;
            
            let gridHTML = '';
            
            // å‚ç›´ç½‘æ ¼çº¿ï¼ˆåªåœ¨æ³¢å½¢åŒºåŸŸæ˜¾ç¤ºï¼‰
            for (let x = 0; x <= width; x += width / 10) {
                gridHTML += `<line x1="${x}" y1="${waveformAreaTop}" x2="${x}" y2="${waveformAreaTop + waveformAreaHeight}" stroke="${gridColor}" stroke-width="1"/>`;
            }
            
            // æ°´å¹³ç½‘æ ¼çº¿ï¼ˆåªåœ¨æ³¢å½¢åŒºåŸŸæ˜¾ç¤ºï¼‰
            for (let y = waveformAreaTop; y <= waveformAreaTop + waveformAreaHeight; y += waveformAreaHeight / 6) {
                gridHTML += `<line x1="0" y1="${y}" x2="${width}" y2="${y}" stroke="${gridColor}" stroke-width="1"/>`;
            }
            
            svg.innerHTML = gridHTML;
        }

        function updateChartContainer() {
            const backgroundColor = getBackgroundColor();
            const textColor = getTextColor(backgroundColor);
            const chartContainer = document.querySelector('.chart-container');
            const chartTitle = document.querySelector('.chart-title');
            
            // æ›´æ–°å›¾è¡¨å®¹å™¨èƒŒæ™¯
            chartContainer.style.background = backgroundColor;
            
            // æ›´æ–°æ ‡é¢˜æ–‡å­—é¢œè‰²
            chartTitle.style.color = textColor;
        }

        function updateLegend() {
            const showLegend = document.getElementById('showLegend').checked;
            const legend = document.getElementById('legend');
            const channelCount = parseInt(document.getElementById('channelCount').value);
            const scheme = colorSchemes[currentScheme];
            const backgroundColor = getBackgroundColor();
            const textColor = getTextColor(backgroundColor);
            
            if (!showLegend) {
                legend.innerHTML = '';
                return;
            }
            
            let legendHTML = '';
            for (let i = 0; i < channelCount; i++) {
                const color = scheme.colors[i % scheme.colors.length];
                legendHTML += `
                    <div class="legend-item" style="color: ${textColor};">
                        <div class="legend-color" style="background: ${color};"></div>
                        <span>Channel${i + 1}</span>
                    </div>
                `;
            }
            
            legend.innerHTML = legendHTML;
        }

        function updateColorValues() {
            const scheme = colorSchemes[currentScheme];
            const channelCount = parseInt(document.getElementById('channelCount').value);
            const colorValues = document.getElementById('colorValues');
            
            let html = `<h4>${scheme.name}</h4>`;
            html += `<p>${scheme.description}</p><br>`;
            html += `<strong>é€šé“æ•°é‡:</strong> ${channelCount}<br>`;
            html += `<strong>é…è‰²æ–¹æ¡ˆé¢œè‰²æ•°:</strong> ${scheme.colors.length}<br><br>`;
            html += `<strong>é¢œè‰²å€¼:</strong><br><br>`;
            
            for (let i = 0; i < channelCount; i++) {
                const color = scheme.colors[i % scheme.colors.length];
                html += `Channel${i + 1}: ${color}<br>`;
            }
            
            colorValues.innerHTML = html;
        }

        function updateComparisonColorValues() {
            const currentSchemeData = colorSchemes[currentScheme];
            const comparisonSchemeKey = document.getElementById('comparisonScheme').value;
            const comparisonSchemeData = colorSchemes[comparisonSchemeKey];
            const channelCount = parseInt(document.getElementById('channelCount').value);
            const colorValues = document.getElementById('colorValues');
            
            let html = `<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">`;
            
            // å½“å‰æ–¹æ¡ˆä¿¡æ¯
            html += `<div>`;
            html += `<h4 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px;">å½“å‰æ–¹æ¡ˆ: ${currentSchemeData.name}</h4>`;
            html += `<p style="margin: 10px 0;">${currentSchemeData.description}</p>`;
            html += `<strong>é€šé“æ•°é‡:</strong> ${channelCount}<br>`;
            html += `<strong>é…è‰²æ–¹æ¡ˆé¢œè‰²æ•°:</strong> ${currentSchemeData.colors.length}<br><br>`;
            html += `<strong>é¢œè‰²å€¼:</strong><br>`;
            
            for (let i = 0; i < channelCount; i++) {
                const color = currentSchemeData.colors[i % currentSchemeData.colors.length];
                html += `Channel${i + 1}: ${color}<br>`;
            }
            html += `</div>`;
            
            // å¯¹æ¯”æ–¹æ¡ˆä¿¡æ¯
            html += `<div>`;
            html += `<h4 style="color: #2c3e50; border-bottom: 2px solid #e74c3c; padding-bottom: 5px;">å¯¹æ¯”æ–¹æ¡ˆ: ${comparisonSchemeData.name}</h4>`;
            html += `<p style="margin: 10px 0;">${comparisonSchemeData.description}</p>`;
            html += `<strong>é€šé“æ•°é‡:</strong> ${channelCount}<br>`;
            html += `<strong>é…è‰²æ–¹æ¡ˆé¢œè‰²æ•°:</strong> ${comparisonSchemeData.colors.length}<br><br>`;
            html += `<strong>é¢œè‰²å€¼:</strong><br>`;
            
            for (let i = 0; i < channelCount; i++) {
                const color = comparisonSchemeData.colors[i % comparisonSchemeData.colors.length];
                html += `Channel${i + 1}: ${color}<br>`;
            }
            html += `</div>`;
            
            html += `</div>`;
            
            colorValues.innerHTML = html;
        }

        function startAnimation() {
            function animate() {
                if (document.getElementById('comparisonMode').checked) {
                    updateComparisonDisplay();
                } else {
                    updateDisplay();
                }
                animationId = requestAnimationFrame(animate);
            }
            animate();
        }

        function stopAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
        }

        function getExportInfo() {
            const scheme = colorSchemes[currentScheme];
            const channelCount = parseInt(document.getElementById('channelCount').value);
            const isComparison = document.getElementById('comparisonMode').checked;
            const backgroundColor = document.getElementById('backgroundColor').value;
            const waveformType = document.getElementById('waveformType').value;
            const enableColorGroups = document.getElementById('enableColorGroups').checked;
            
            let info = {
                schemeName: scheme.name,
                schemeDescription: scheme.description,
                channelCount: channelCount,
                totalColors: scheme.colors.length,
                backgroundColor: backgroundColor,
                waveformType: waveformType,
                isComparison: isComparison,
                enableColorGroups: enableColorGroups,
                colors: scheme.colors.slice(0, Math.min(channelCount, scheme.colors.length))
            };
            
            if (isComparison) {
                const comparisonSchemeKey = document.getElementById('comparisonScheme').value;
                const comparisonScheme = colorSchemes[comparisonSchemeKey];
                info.comparisonSchemeName = comparisonScheme.name;
                info.comparisonColors = comparisonScheme.colors.slice(0, Math.min(channelCount, comparisonScheme.colors.length));
            }
            
            if (enableColorGroups) {
                const groupCount = parseInt(document.getElementById('colorGroupCount').value);
                const colorsPerGroup = parseInt(document.getElementById('colorsPerGroup').value);
                info.colorGroups = {
                    groupCount: groupCount,
                    colorsPerGroup: colorsPerGroup
                };
            }
            
            return info;
        }
        
        function showExportConfirmation(exportType, callback) {
            const info = getExportInfo();
            
            let message = `ğŸ“Š å¯¼å‡ºé…è‰²æ–¹æ¡ˆç¡®è®¤\n\n`;
            message += `å¯¼å‡ºæ ¼å¼: ${exportType}\n`;
            message += `é…è‰²æ–¹æ¡ˆ: ${info.schemeName}\n`;
            message += `æ–¹æ¡ˆæè¿°: ${info.schemeDescription}\n`;
            message += `é€šé“æ•°é‡: ${info.channelCount}\n`;
            message += `èƒŒæ™¯é¢œè‰²: ${info.backgroundColor}\n`;
            message += `æ³¢å½¢ç±»å‹: ${info.waveformType}\n`;
            
            if (info.isComparison) {
                message += `\nğŸ”„ å¯¹æ¯”æ¨¡å¼å·²å¯ç”¨\n`;
                message += `å½“å‰æ–¹æ¡ˆ: ${info.schemeName}\n`;
                message += `å¯¹æ¯”æ–¹æ¡ˆ: ${info.comparisonSchemeName}\n`;
                message += `æ³¨æ„: å°†å¯¼å‡ºå½“å‰é€‰ä¸­çš„ä¸»æ–¹æ¡ˆ (${info.schemeName})\n`;
            }
            
            if (info.enableColorGroups) {
                message += `\nğŸ¨ è‰²ç³»åˆ†ç»„å·²å¯ç”¨\n`;
                message += `è‰²ç³»æ•°é‡: ${info.colorGroups.groupCount}\n`;
                message += `æ¯ç»„é¢œè‰²æ•°: ${info.colorGroups.colorsPerGroup}\n`;
            }
            
            message += `\nğŸ¨ ä½¿ç”¨çš„é¢œè‰²å€¼:\n`;
            info.colors.forEach((color, index) => {
                message += `Channel${index + 1}: ${color}\n`;
            });
            
            message += `\nç¡®è®¤å¯¼å‡ºæ­¤é…è‰²æ–¹æ¡ˆå—ï¼Ÿ`;
            
            if (confirm(message)) {
                callback();
            }
        }

        function exportColorScheme() {
            showExportConfirmation('JSON', () => {
                const scheme = colorSchemes[currentScheme];
                const channelCount = parseInt(document.getElementById('channelCount').value);
                const exportData = {
                    name: scheme.name,
                    description: scheme.description,
                    colors: scheme.colors.slice(0, channelCount),
                    channelCount: channelCount,
                    exportDate: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `easychartx-colors-${currentScheme}.json`;
                link.click();
                URL.revokeObjectURL(url);
            });
        }

        function exportCSS() {
            showExportConfirmation('CSS', () => {
                const scheme = colorSchemes[currentScheme];
                const channelCount = parseInt(document.getElementById('channelCount').value);
                
                let css = `/* EasyChartX ${scheme.name} é…è‰²æ–¹æ¡ˆ */\n`;
                css += `/* ${scheme.description} */\n\n`;
                css += `:root {\n`;
                
                for (let i = 0; i < Math.min(channelCount, scheme.colors.length); i++) {
                    css += `  --channel-${i + 1}-color: ${scheme.colors[i]};\n`;
                }
                
                css += `}\n\n`;
                css += `.waveform-channel-1 { stroke: var(--channel-1-color); }\n`;
                
                for (let i = 1; i < Math.min(channelCount, scheme.colors.length); i++) {
                    css += `.waveform-channel-${i + 1} { stroke: var(--channel-${i + 1}-color); }\n`;
                }
                
                const dataBlob = new Blob([css], {type: 'text/css'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `easychartx-colors-${currentScheme}.css`;
                link.click();
                URL.revokeObjectURL(url);
            });
        }

        function exportCode() {
            showExportConfirmation('JavaScript', () => {
                const scheme = colorSchemes[currentScheme];
                const channelCount = parseInt(document.getElementById('channelCount').value);
                
                let code = `// EasyChartX ${scheme.name} é…è‰²æ–¹æ¡ˆ\n`;
                code += `// ${scheme.description}\n\n`;
                code += `const channelColors = [\n`;
                
                for (let i = 0; i < Math.min(channelCount, scheme.colors.length); i++) {
                    code += `    "${scheme.colors[i]}"${i < Math.min(channelCount, scheme.colors.length) - 1 ? ',' : ''} // Channel ${i + 1}\n`;
                }
                
                code += `];\n\n`;
                code += `// ä½¿ç”¨ç¤ºä¾‹:\n`;
                code += `// chart.setChannelColor(channelIndex, channelColors[channelIndex]);\n`;
                
                const dataBlob = new Blob([code], {type: 'text/javascript'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `easychartx-colors-${currentScheme}.js`;
                link.click();
                URL.revokeObjectURL(url);
            });
        }

        // è¾…åŠ©å‡½æ•°ï¼šå°†åå…­è¿›åˆ¶é¢œè‰²è½¬æ¢ä¸ºC#é¢œè‰²ä»£ç 
        function hexToColor(hex) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `Color.FromArgb(${r}, ${g}, ${b})`;
        }

        function exportCSharp() {
            showExportConfirmation('C#', () => {
                const scheme = colorSchemes[currentScheme];
                const channelCount = parseInt(document.getElementById('channelCount').value);
                
                let code = `// EasyChartX ${scheme.name} é…è‰²æ–¹æ¡ˆ\n`;
                code += `// ${scheme.description}\n`;
                code += `// é€šé“æ•°é‡: ${channelCount}\n`;
                code += `// é…è‰²æ–¹æ¡ˆé¢œè‰²æ•°: ${scheme.colors.length}\n`;
                code += `// ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString('zh-CN')}\n\n`;
                code += `using System.Drawing;\n\n`;
                
                code += `private void GuiRefresh_Click(object sender, EventArgs e)\n`;
                code += `{\n`;
                
                // è®¾ç½®å›¾è¡¨èƒŒæ™¯å’Œæ ·å¼
                code += `    // è®¾ç½®å›¾è¡¨èƒŒæ™¯å’Œæ ·å¼\n`;
                code += `    easyChartX1.BackColor = Color.Black;\n`;
                code += `    easyChartX1.ChartAreaBackColor = Color.Black;\n\n`;
                
                // è®¾ç½®åæ ‡è½´å’Œç½‘æ ¼çº¿
                code += `    // è®¾ç½®åæ ‡è½´å’Œç½‘æ ¼çº¿\n`;
                code += `    easyChartX1.AxisX.Color = Color.Gray;\n`;
                code += `    easyChartX1.AxisX.MajorGridColor = Color.Gray;\n`;
                code += `    easyChartX1.AxisX.MinorGridColor = Color.Gray;\n`;
                code += `    easyChartX1.AxisY.Color = Color.Gray;\n`;
                code += `    easyChartX1.AxisY.MajorGridColor = Color.Gray;\n`;
                code += `    easyChartX1.AxisY.MinorGridColor = Color.Gray;\n\n`;
                
                // è®¾ç½®å›¾ä¾‹
                code += `    // è®¾ç½®å›¾ä¾‹\n`;
                code += `    easyChartX1.LegendBackColor = Color.Black;\n`;
                code += `    easyChartX1.LegendForeColor = Color.White;\n`;
                code += `    easyChartX1.LegendVisible = true;\n\n`;
                
                // è·å–æ›²çº¿é¢œè‰²è¡¨
                code += `    // è·å–æ›²çº¿é¢œè‰²è¡¨\n`;
                code += `    var colorTable = new Color[${scheme.colors.length}];\n`;
                
                for (let i = 0; i < scheme.colors.length; i++) {
                    const colorValue = hexToColor(scheme.colors[i]);
                    code += `    colorTable[${i}] = ${colorValue}; // ${scheme.colors[i]}\n`;
                }
                
                code += `\n    // è®¾ç½®è¦ç»˜åˆ¶çš„æ›²çº¿ä¸ªæ•°\n`;
                code += `    int numOfWaveforms = ${channelCount};\n`;
                code += `    easyChartX1.Series.AdaptSeriesCount(numOfWaveforms);\n\n`;
                
                // æ ¹æ®æ›²çº¿é¢œè‰²è¡¨å¾ªç¯è®¾ç½®å„æ›²çº¿çš„é¢œè‰²
                code += `    // æ ¹æ®æ›²çº¿é¢œè‰²è¡¨å¾ªç¯è®¾ç½®å„æ›²çº¿çš„é¢œè‰²\n`;
                if (channelCount <= scheme.colors.length) {
                    code += `    // ç›´æ¥è®¾ç½®å„æ›²çº¿çš„é¢œè‰²\n`;
                    code += `    for (int i = 0; i < numOfWaveforms; i++)\n`;
                    code += `    {\n`;
                    code += `        easyChartX1.Series[i].Color = colorTable[i];\n`;
                    code += `    }\n\n`;
                } else {
                    code += `    // å¦‚æœæ›²çº¿ä¸ªæ•°å¤§äºé¢œè‰²è¡¨é•¿åº¦ï¼Œåˆ™å¾ªç¯ä½¿ç”¨\n`;
                    code += `    for (int i = 0; i < numOfWaveforms; i++)\n`;
                    code += `    {\n`;
                    code += `        easyChartX1.Series[i].Color = colorTable[i % colorTable.Length];\n`;
                    code += `    }\n\n`;
                }
                
                // ç”Ÿæˆæ³¢å½¢æ•°æ®ç¤ºä¾‹
                code += `    // ç”Ÿæˆæ³¢å½¢æ•°æ®ç¤ºä¾‹\n`;
                code += `    int numOfSamples = 2000;\n`;
                code += `    var oneChannelWaveform = new double[numOfSamples];\n`;
                code += `    var allWaveforms = new double[numOfSamples, numOfWaveforms];\n`;
                code += `    for (int i = 0; i < numOfWaveforms; i++)\n`;
                code += `    {\n`;
                code += `        Generation.SineWave(ref oneChannelWaveform, 1, i * 10);\n`;
                code += `        for (int j = 0; j < numOfSamples; j++)\n`;
                code += `        {\n`;
                code += `            allWaveforms[j, i] = oneChannelWaveform[j];\n`;
                code += `        }\n`;
                code += `    }\n\n`;
                
                code += `    // ç»˜åˆ¶æ³¢å½¢\n`;
                code += `    easyChartX1.Plot(allWaveforms, 0, 1);\n`;
                code += `}\n`;
                
                const dataBlob = new Blob([code], {type: 'text/plain'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `easychartx-colors-${currentScheme}.cs`;
                link.click();
                URL.revokeObjectURL(url);
            });
        }

        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°ç»˜åˆ¶
        window.addEventListener('resize', function() {
            setTimeout(updateDisplay, 100);
        });
    </script>
</body>
</html>
